{"version":3,"sources":["kill-cms.js"],"names":[],"mappings":"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","file":"kill-cms.js","sourcesContent":["/**\r\n * Copyright (c) Xinhuanet Inc. All rights reserved.\r\n *\r\n * @License: MIT\r\n * @Author: SuperWoods\r\n * @Email:  st_sister@iCloud.com\r\n * @Date:   2016-08-09-06:45:42\r\n *\r\n * @(demo)Last modified by:   SuperWoods\r\n * @(demo)Last modified time: 2016-08-10-09:55:48\r\n */\r\n\r\n$(() => {\r\n    let cloneDOM = ($tempDOM, tempDOM) => {\r\n        $tempDOM.html(tempDOM);\r\n    }\r\n    let killHandler = ($tempDOM) => {\r\n        let $output = $('#output');\r\n        let nodeid = $('#nodeid').val();\r\n        let attr = $('#attr').attr('data-attr');\r\n        let repeat = $('#repeat').val();\r\n\r\n        // let n = '\\n';\r\n        let n = '';\r\n        let cms = {\r\n            begin: '<!--webbot bot=\"AdvTitleList\" nodeid=\"' + ((nodeid === '') ? '888888' : nodeid) + '\" type=\"0\" spanmode=\"0\" dayspan=\"0\" attr=\"' + ((attr === '') ? '' : ('+' + attr)) + '\" comstring=\"' + n,\r\n            lt: '&lt;',\r\n            gt: '&gt;',\r\n            enpquot: '#enpquot#',\r\n            Picture: {\r\n                needcode: [\r\n                    '<img data-src=\"<Picture needcode=0>PictureUrlPh</Picture>\">',\r\n                    '<img data-original=\"<Picture needcode=0>PictureUrlPh</Picture>\">',\r\n                    // '<img data-src=\"<Picture needcode=0>PictureUrlPh</Picture>\" width=\"' + imgWidth + '\" height=\"' + imgHeight + '\" alt=\"<Title length=\"0\">TitlePh</Title>\">',\r\n                    '<Picture needcode=1 width=100 height=100>PictureUrlPh</Picture>'\r\n                ]\r\n            },\r\n            Title: '<Title length=\"0\">TitlePh</Title>',\r\n            ArticleUrlPh: 'ArticleUrlPh',\r\n            Abstract: '<Abstract>AbstractPh</Abstract>',\r\n            Subtitle: n + '<Subtitle>SubtitlePh</Subtitle>',\r\n            end: '\" TAG=\"BODY\" PREVIEW=\"[高级标题列表]\" artattr=\"0\" isshowcode=\"0\" titlekeyword=\"\" keyword=\"\" tagstring=\"00\" starttime=\"\" endtime=\"\" id=\"\" startspan --><!--webbot bot=\"AdvTitleList\" endspan i-checksum=\"0\" -->'\r\n        };\r\n\r\n\r\n\r\n        console.log('orgHtml0:', $tempDOM.html());\r\n\r\n        let $a = $tempDOM.find('a');\r\n        let $abs = $tempDOM.find('.abs');\r\n        let $subTitle = $tempDOM.find('.subTitle');\r\n        let $ul = $tempDOM.find('ul');\r\n\r\n        let $img = $tempDOM.find('img');\r\n        let imgWidth = $img.attr('width');\r\n        let imgHeight = $img.attr('height');\r\n\r\n        // 处理 a 内部内容\r\n        $a.each(function () {\r\n            var _this = $(this);\r\n            if (_this.find('img').length === 0) {\r\n                _this.text(cms.Title);\r\n            }\r\n        });\r\n\r\n        // 处理 $abs\r\n        $abs.each(function () {\r\n            let _this = $(this);\r\n            if (_this.find('a')) {\r\n                let aText = _this.find('a').text();\r\n                _this.text(cms.Abstract + 'UrlBegin<a href=\"' + cms.ArticleUrlPh + '\">UrlEnd' + aText + '</a>');\r\n            } else {\r\n                _this.text(cms.Abstract);\r\n            }\r\n        });\r\n\r\n        // 处理 $subTitle\r\n        $subTitle.each(function () {\r\n            let _this = $(this);\r\n            if (_this.find('a')) {\r\n                _this.text('UrlBegin<a href=\"' + cms.ArticleUrlPh + '\">UrlEnd' + cms.Subtitle + '</a>');\r\n            } else {\r\n                _this.text(cms.Subtitle);\r\n            }\r\n        });\r\n\r\n        // 处理 a href自身\r\n        $a.attr('href', cms.ArticleUrlPh).before('UrlBegin').prepend('UrlEnd');\r\n\r\n        // 处理 img\r\n        $img.each(function () {\r\n            let _this = $(this);\r\n            _this.replaceWith(() => {\r\n                let temp = cms.Picture.needcode[2];\r\n                if (_this.attr('data-src')) {\r\n                    temp = cms.Picture.needcode[0]\r\n                } else if (_this.attr('data-original')) {\r\n                    temp = cms.Picture.needcode[1]\r\n                }\r\n                return temp;\r\n            });\r\n        });\r\n\r\n        let orgHtml = $tempDOM.html();\r\n\r\n        // 获取处理后的 DOM\r\n        let $li = $ul.find('li');\r\n        let size = $li.size();\r\n        console.log(size);\r\n        if ($ul && size > 1) {\r\n            orgHtml =\r\n                '<ul' + (($ul.hasClass('list')) ? ' class=\"list\"' : '') + '>' + n +\r\n                '<Repeat Begin=0 End=' + size + '>' + n +\r\n                '<Article>' + n +\r\n                '<li>' + $li.eq(0).html() + '</li>' + n +\r\n                '</Article>' + n +\r\n                '</Repeat>' + n +\r\n                '</ul>' + n;\r\n        } else {\r\n            // 添加 Article\r\n            orgHtml = '<Article>' + n + orgHtml + '</Article>' + n;\r\n            // 添加 Repeat\r\n            if (repeat !== '' && repeat > 0) {\r\n                orgHtml = '<Repeat Begin=0 End=' + repeat + '>' + n + orgHtml + '</Repeat>' + n;\r\n            }\r\n        }\r\n\r\n\r\n\r\n\r\n\r\n\r\n        console.log('orgHtml1:', orgHtml);\r\n\r\n        // 转码\r\n        orgHtml = orgHtml\r\n            .replace(/picture/g, 'Picture')\r\n            .replace(/UrlBegin/g, '<Url>')\r\n            .replace(/UrlEnd/g, '</Url>')\r\n            .replace(/</g, cms.lt)\r\n            .replace(/>/g, cms.gt)\r\n            .replace(/\"/g, cms.enpquot);\r\n\r\n        console.log('newHtml:', orgHtml);\r\n\r\n        let outputTemp = '';\r\n        outputTemp =\r\n            cms.begin +\r\n            orgHtml +\r\n            cms.end;\r\n\r\n        $output.text(outputTemp);\r\n    }\r\n\r\n    let $submit = $('#submit');\r\n    $submit.on('click', () => {\r\n\r\n        let $input = $('#input');\r\n        let tempDOM = $input.val();\r\n        let $tempDOM = $('#tempDOM');\r\n\r\n        cloneDOM($tempDOM, tempDOM);\r\n        killHandler($tempDOM);\r\n        // if (tempDOM !== '') {\r\n        //\r\n        // } else {\r\n        //     alert('你在逗我吗？');\r\n        // }\r\n    });\r\n\r\n});\r\n"],"sourceRoot":"/source/"}